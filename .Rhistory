plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
round(quantile(random.effect, probs=seq(0,1,0.2)), digits=2)
round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
# brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
my.colours <- c("green",, "lightblue" "orange2", "red3")
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
my.colours <- c("green","lightblue" "orange2", "red3")
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
my.colours <- c("green","lightblue", "orange2", "red3")
brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
my.colours <- c("green","yellow", "orange2", "red3")
brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
my.colours <- c("green","aquamarine", "orange2", "red3")
brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# my.colours <- c("green","aquamarine", "orange2", "red3")
brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# my.colours <- c("green","aquamarine", "orange2", "red3")
# brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
brks <- c(min(random.effect), -0.3, 0, 0.35, max(random.effect))
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
my.colours <- c("yellow", "orange2", "red3", "black")
# brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
brks <- c(min(random.effect), -0.3, 0, 0.35, max(random.effect))
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
brks <- round(quantile(NW.dataset$SMR, probs=seq(0,1,0.2)), digits=2)
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.7,3))
plot(NW.dataset, col=my.colours[findInterval(SMR, brks,all.inside=TRUE)], main="SMR")
text(coordinates(NW.dataset), label=round(SMR, digits=2),cex=0.5)
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.83, title="Percentils")
plot.new()
legend("center", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=1, title="Percentils")
brks <- round(quantile(RR.vector, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(RR.vector, brks,all.inside=TRUE)], main="RR")
text(coordinates(NW.dataset), label=round(RR.vector, digits=2),cex=0.5)
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.83, title="Percentils")
resid=chosen.model$mean$resid
random.effect = log(resid)
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
my.colours <- c("green","aquamarine", "orange2", "red3")
# brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
brks <- c(min(random.effect), -0.3, 0, 0.35, max(random.effect))
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
my.colours <- c("darkgreen", "green", "orange2", "red3")
# brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
brks <- c(min(random.effect), -0.3, 0, 0.35, max(random.effect))
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
my.colours <- c("darkgreen", "green", "orange2", "red3")
# brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
brks <- c(min(random.effect), -0.3, 0, 0.35, max(random.effect))
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# my.colours <- c("yellow", "orange2", "red3", "black")
# brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
brks = c(min(resid), 0.74, 1, 1.41, max(resid))
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
# hist(SMR, xlab="Standardized Mortality Rate (SMR)", main="")
laryx.Poisson<-paste(getwd(),"/laringe_poisson_model.odc",sep="")
laryx.inits<-list(
list(alpha0=0),
list(alpha0=-5e-01),
list(alpha0=rnorm(1))
)
path.winbugs<-paste("C:\\Users\\lofer\\WinBUGS14")
mybugsdir<-"C:\\Users\\lofer\\OneDrive\\Documenti\\GitHub\\Epidemiology_2nd_Assignment\\Poisson"
results.Poisson<-bugs(data=data, inits=laryx.inits,
# parameters.to.save = c("RR","alpha0"),
parameters.to.save = c("alpha0"),
model.file=laryx.Poisson, n.chains=3, n.iter=2000, n.burnin = 1000,
bugs.directory=path.winbugs, debug=debug_on, codaPkg=codaPkg_on, working.directory=mybugsdir)
library(spdep)
library(sf)
library(classInt)
library(maptools)
library(R2WinBUGS)
library(foreign)
library(spatialreg)
# load("data.Rdata")
mybugsdir<-"C:\\Users\\lofer\\OneDrive\\Documenti\\GitHub\\Epidemiology_2nd_Assignment\\Poisson"
results.Poisson<-bugs(data=data, inits=laryx.inits,
# parameters.to.save = c("RR","alpha0"),
parameters.to.save = c("alpha0"),
model.file=laryx.Poisson, n.chains=3, n.iter=2000, n.burnin = 1000,
bugs.directory=path.winbugs, debug=debug_on, codaPkg=codaPkg_on, working.directory=mybugsdir)
print(results.Poisson)
rm(list=ls())
data = list(
N = 144,
O = c(5, 7, 0, 0, 8, 5, 1, 10, 3, 5,
4, 7, 3, 6, 1, 5, 4, 6, 3, 3, 2, 2, 9, 8, 6, 10, 9, 15, 14, 12,
11, 23, 12, 4, 27, 10, 10, 10, 13, 10, 7, 13, 16, 4, 9, 4, 13,
4, 10, 12, 18, 13, 25, 5, 12, 6, 5, 2, 3, 6, 4, 4, 6, 1, 5, 9,
7, 1, 5, 1, 4, 3, 3, 2, 3, 9, 5, 9, 19, 4, 12, 1, 2, 8, 6, 4,
2, 4, 8, 4, 6, 7, 4, 10, 4, 7, 8, 12, 12, 8, 6, 2, 7, 7, 7, 4,
10, 8, 3, 5, 6, 9, 3, 10, 9, 8, 9, 6, 3, 1, 0, 1, 1, 3, 1, 0,
1, 0, 2, 5, 0, 0, 1, 0, 0, 1, 2, 4, 2, 2, 3, 0, 0, 1),
E = c(2.53, 3.94, 3.09, 2.75, 3.81, 3.66, 4.05, 3.07, 3.42, 4.24, 3.9, 3.58,
3.68, 3.19, 5.15, 3.75, 3.37, 4.52, 1.94, 3.47, 3.48, 3.32, 4.52,
9.2, 10.37, 8.08, 6.66, 7.7, 9.79, 9.77, 10.17, 9.93, 9.53, 10.59,
7.64, 7.03, 4.09, 7.66, 8.02, 6.78, 9.85, 7.98, 8.14, 4.07, 7.54,
7.04, 7.99, 8.1, 5.69, 6.37, 8.2, 6.52, 4.68, 9.11, 11.28, 6.18,
4.79, 4.98, 6.47, 5.43, 6.51, 4.44, 6.69, 5.55, 6.24, 5.27, 5.61,
5.31, 6.92, 5.17, 5.13, 3.73, 6.18, 9.44, 7.3, 7.63, 11.66, 6.52,
6.64, 10.64, 7.15, 8.76, 7.48, 6.06, 6.36, 7.98, 8.92, 9.07,
6.2, 7.37, 6.68, 8.62, 8.05, 5.97, 8.65, 7.04, 8.91, 5.95, 7.5,
9.11, 10.59, 7.64, 8.91, 8.72, 11.7, 10.69, 7.73, 8.52, 7.81,
9.24, 8.25, 10.72, 10.33, 8.19, 10.9, 7, 9.98, 10.1, 2.33, 3.49,
0.78, 3.59, 2.47, 4.1, 1.82, 0.71, 1.44, 1.76, 3.39, 2.19, 1.66,
1.35, 2.27, 2.11, 1.05, 2.22, 3.24, 2.65, 3.15, 1.94, 3.13, 1.95,
2.16, 1.76))
SMR = data$O/data$E
lunghezza = length(SMR)
debug_on=F
codaPkg_on=F
load("data.Rdata")
print(results.Poisson)
model.glm <- glm(O ~ 1, offset=E, family = quasipoisson(link = "log"), data=data)
summary(model.glm)
print(results.heterogenity)
max( results.spatial$summary[,8] )
max( results.spatial$summary[,8] )
max( results.heterogenity$summary[,8] )
max( results.convo$summary[,8] )
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
brks <- round(quantile(NW.dataset$SMR, probs=seq(0,1,0.2)), digits=2)
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.7,3))
plot(NW.dataset, col=my.colours[findInterval(SMR, brks,all.inside=TRUE)], main="SMR")
text(coordinates(NW.dataset), label=round(SMR, digits=2),cex=0.5)
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.83, title="Percentils")
plot.new()
legend("center", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=1, title="Percentils")
brks <- round(quantile(RR.vector, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(RR.vector, brks,all.inside=TRUE)], main="RR")
text(coordinates(NW.dataset), label=round(RR.vector, digits=2),cex=0.5)
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.83, title="Percentils")
st.SMR<-(NW.dataset$SMR-mean(NW.dataset$SMR))/sd(NW.dataset$SMR)
xx<-moran.plot(st.SMR, weight.object ,labels=as.factor(NW.dataset$NAME), pch=19, main="Moran Plot")
summary(xx)
xx$x
xx$wx
xx$is_inf
xx$hat
xx$cook.d
xx$cook.d[50]
xx$cook.d[130]
xx$cook.d[53]
xx$cook.d[35]
xx$cook.d[32]
xx$cook.d[84]
xx$cook.d[28]
xx$cook.d[1]
xx$cook.d[2]
xx$cook.d[3]
sids.local.moran<-localmoran(NW.dataset$SMR , weight.object)
dat<-data.frame(name = NW.dataset$NAME,sids.local.moran)
colnames(dat)[6]="P-value"
slot(NW.dataset,"data")<-cbind(slot(NW.dataset,"data"),sids.local.moran)
#Intervals
l.inf<-round(min(NW.dataset$Ii),digits=2)
l.sup<-round(max(NW.dataset$Ii),digits=2)
I.b5<-findInterval(NW.dataset$Ii,c((l.inf-0.01),-1,-0.5,0.5,1.5,(l.sup+0.01)))
breakI<-c((l.inf-0.1),-1,-0.5,0.5,1.5,(l.sup+0.1))
pal.I<- c("yellow3", "orange2", "gray80", "grey60","grey15")
# to look a list of colours of the R, use the function colours()
#Colour assignment based on intervals
plot(NW.dataset, col=pal.I[I.b5], main="Test statistic")
text(coordinates(NW.dataset),label=as.factor(NW.dataset$NAME),cex=0.4)
legend("bottomright", legend=leglabs(breakI),fill=pal.I, cex=0.4)#, bty="n")
l.inf
l.sup
l.inf-0.1
l.sup+0.1
plot(NW.dataset, col=my.colours[findInterval(NW.dataset$SMR, brks,all.inside=TRUE)])
legend("right", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.4)
title(main=paste("Standardized Mortality Rate (SMR) during 1982-1991"))
text(coordinates(NW.dataset),label=as.factor(NW.dataset$NAME),cex=0.4)
plot(NW.dataset, col=my.colours[findInterval(NW.dataset$SMR, brks,all.inside=TRUE)])
legend("right", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.99)
title(main=paste("Standardized Mortality Rate (SMR) during 1982-1991"))
text(coordinates(NW.dataset),label=as.factor(NW.dataset$NAME),cex=0.4)
sids.local.moran
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
plot(NW.dataset, col=my.colours[findInterval(NW.dataset$SMR, brks,all.inside=TRUE)])
legend("right", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.99)
title(main=paste("Standardized Mortality Rate (SMR) during 1982-1991"))
text(coordinates(NW.dataset),label=as.factor(NW.dataset$NAME),cex=0.4)
brks <- round(quantile(NW.dataset$SMR, probs=seq(0,1,0.2)), digits=2)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
plot(NW.dataset, col=my.colours[findInterval(NW.dataset$SMR, brks,all.inside=TRUE)])
legend("right", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.99)
title(main=paste("Standardized Mortality Rate (SMR) during 1982-1991"))
text(coordinates(NW.dataset),label=as.factor(NW.dataset$NAME),cex=0.4)
sids.local.moran<-localmoran(NW.dataset$SMR , weight.object)
dat<-data.frame(name = NW.dataset$NAME,sids.local.moran)
colnames(dat)[6]="P-value"
slot(NW.dataset,"data")<-cbind(slot(NW.dataset,"data"),sids.local.moran)
#Intervals
l.inf<-round(min(NW.dataset$Ii),digits=2)
l.sup<-round(max(NW.dataset$Ii),digits=2)
I.b5<-findInterval(NW.dataset$Ii,c((l.inf-0.01),-1,-0.5,0.5,1.5,(l.sup+0.01)))
breakI<-c((l.inf-0.1),-1,-0.5,0.5,1.5,(l.sup+0.1))
pal.I<- c("yellow3", "orange2", "gray80", "grey60","grey15")
# to look a list of colours of the R, use the function colours()
#Colour assignment based on intervals
plot(NW.dataset, col=pal.I[I.b5], main="Test statistic")
text(coordinates(NW.dataset),label=as.factor(NW.dataset$NAME),cex=0.4)
legend("bottomright", legend=leglabs(breakI),fill=pal.I, cex=0.4)#, bty="n")
plot(NW.dataset, col=my.colours[findInterval(NW.dataset$SMR, brks,all.inside=TRUE)])
legend("right", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.4)
title(main=paste("Standardized Mortality Rate (SMR) during 1982-1991"))
text(coordinates(NW.dataset),label=as.factor(NW.dataset$NAME),cex=0.4)
brks <- round(quantile(NW.dataset$SMR, probs=seq(0,1,0.2)), digits=2)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
plot(NW.dataset, col=my.colours[findInterval(NW.dataset$SMR, brks,all.inside=TRUE)])
legend("right", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.99)
title(main=paste("Standardized Mortality Rate (SMR) during 1982-1991"))
text(coordinates(NW.dataset),label=as.factor(NW.dataset$NAME),cex=0.4)
plot(NW.dataset, col=my.colours[findInterval(NW.dataset$SMR, brks,all.inside=TRUE)])
legend("right", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.4)
title(main=paste("Standardized Mortality Rate (SMR) during 1982-1991"))
text(coordinates(NW.dataset),label=as.factor(NW.dataset$NAME),cex=0.4)
sids.local.moran<-localmoran(NW.dataset$SMR , weight.object)
dat<-data.frame(name = NW.dataset$NAME,sids.local.moran)
colnames(dat)[6]="P-value"
slot(NW.dataset,"data")<-cbind(slot(NW.dataset,"data"),sids.local.moran)
#Intervals
l.inf<-round(min(NW.dataset$Ii),digits=2)
l.sup<-round(max(NW.dataset$Ii),digits=2)
I.b5<-findInterval(NW.dataset$Ii,c((l.inf-0.01),-1,-0.5,0.5,1.5,(l.sup+0.01)))
breakI<-c((l.inf-0.1),-1,-0.5,0.5,1.5,(l.sup+0.1))
pal.I<- c("yellow3", "orange2", "gray80", "grey60","grey15")
# to look a list of colours of the R, use the function colours()
#Colour assignment based on intervals
plot(NW.dataset, col=pal.I[I.b5], main="Test statistic")
text(coordinates(NW.dataset),label=as.factor(NW.dataset$NAME),cex=0.4)
legend("bottomright", legend=leglabs(breakI),fill=pal.I, cex=0.4)#, bty="n")
l.sup
l.inf
sids.local.moran<-localmoran(NW.dataset$SMR , weight.object)
dat<-data.frame(name = NW.dataset$NAME,sids.local.moran)
colnames(dat)[6]="P-value"
slot(NW.dataset,"data")<-cbind(slot(NW.dataset,"data"),sids.local.moran)
#Intervals
l.inf<-round(min(NW.dataset$Ii),digits=2)
l.sup<-round(max(NW.dataset$Ii),digits=2)
I.b5<-findInterval(NW.dataset$Ii,c((l.inf-0.01),-1,-0.5,0.5,1.5,(l.sup+0.01)))
breakI<-c((l.inf-0.1),-1,-0.5,0.5,1.5,(l.sup+0.1))
pal.I<- c("yellow3", "orange2", "gray80", "grey60","grey15")
# to look a list of colours of the R, use the function colours()
#Colour assignment based on intervals
plot(NW.dataset, col=pal.I[I.b5], main="Test statistic")
text(coordinates(NW.dataset),label=as.factor(NW.dataset$NAME),cex=0.4)
legend("bottomright", legend=leglabs(breakI),fill=pal.I, cex=0.4)#, bty="n")
sids.local.moran<-localmoran(NW.dataset$SMR , weight.object)
dat<-data.frame(name = NW.dataset$NAME,sids.local.moran)
colnames(dat)[6]="P-value"
slot(NW.dataset,"data")<-cbind(slot(NW.dataset,"data"),sids.local.moran)
#Intervals
l.inf<-round(min(NW.dataset$Ii),digits=2)
l.sup<-round(max(NW.dataset$Ii),digits=2)
I.b5<-findInterval(NW.dataset$Ii,c((l.inf-0.01),-1,-0.5,0.5,1.5,(l.sup+0.01)))
breakI<-c((l.inf-0.1),-1,-0.5,0.5,1.5,(l.sup+0.1))
pal.I<- c("yellow3", "orange2", "gray80", "grey60","grey15")
# to look a list of colours of the R, use the function colours()
#Colour assignment based on intervals
plot(NW.dataset, col=pal.I[I.b5], main="Test statistic")
text(coordinates(NW.dataset),label=as.factor(NW.dataset$NAME),cex=0.4)
legend("right", legend=leglabs(breakI),fill=pal.I, cex=0.4)#, bty="n")
sids.local.moran<-localmoran(NW.dataset$SMR , weight.object)
dat<-data.frame(name = NW.dataset$NAME,sids.local.moran)
colnames(dat)[6]="P-value"
slot(NW.dataset,"data")<-cbind(slot(NW.dataset,"data"),sids.local.moran)
#Intervals
l.inf<-round(min(NW.dataset$Ii),digits=2)
l.sup<-round(max(NW.dataset$Ii),digits=2)
I.b5<-findInterval(NW.dataset$Ii,c((l.inf-0.01),-1,-0.5,0.5,1.5,(l.sup+0.01)))
breakI<-c((l.inf-0.1),-1,-0.5,0.5,1.5,(l.sup+0.1))
pal.I<- c("yellow3", "orange2", "gray80", "grey60","grey15")
# to look a list of colours of the R, use the function colours()
#Colour assignment based on intervals
plot(NW.dataset, col=pal.I[I.b5], main="Test statistic")
text(coordinates(NW.dataset),label=as.factor(NW.dataset$NAME),cex=0.4)
legend("right", legend=leglabs(breakI),fill=pal.I, cex=0.99)#, bty="n")
st.SMR<-(NW.dataset$SMR-mean(NW.dataset$SMR))/sd(NW.dataset$SMR)
# xx<-moran.plot(st.SMR, weight.object ,labels=as.factor(NW.dataset$NAME), pch=19, main="Moran Plot")
chosen.model = results.spatial
chosen.model = results.convo
RR.vector = chosen.model$mean$RR
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
brks <- round(quantile(NW.dataset$SMR, probs=seq(0,1,0.2)), digits=2)
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.7,3))
plot(NW.dataset, col=my.colours[findInterval(SMR, brks,all.inside=TRUE)], main="SMR")
text(coordinates(NW.dataset), label=round(SMR, digits=2),cex=0.5)
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.83, title="Percentils")
plot.new()
legend("center", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=1, title="Percentils")
brks <- round(quantile(RR.vector, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(RR.vector, brks,all.inside=TRUE)], main="RR")
text(coordinates(NW.dataset), label=round(RR.vector, digits=2),cex=0.5)
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.83, title="Percentils")
chosen.model = results.spatial
RR.vector = chosen.model$mean$RR
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
brks <- round(quantile(NW.dataset$SMR, probs=seq(0,1,0.2)), digits=2)
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.7,3))
plot(NW.dataset, col=my.colours[findInterval(SMR, brks,all.inside=TRUE)], main="SMR")
text(coordinates(NW.dataset), label=round(SMR, digits=2),cex=0.5)
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.83, title="Percentils")
plot.new()
legend("center", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=1, title="Percentils")
brks <- round(quantile(RR.vector, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(RR.vector, brks,all.inside=TRUE)], main="RR")
text(coordinates(NW.dataset), label=round(RR.vector, digits=2),cex=0.5)
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.83, title="Percentils")
