for (i in 1:lunghezza) {
prob.vector[i]=sum(RR.simul[,i]>1) / (dim(RR.simul)[1])
}
PV = round(prob.vector, digits = 2)
brks <- round(quantile(PV, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(PV, brks,all.inside=TRUE)], main="PV")
text(coordinates(NW.dataset), label=round(PV, digits=2),cex=0.5)
legend("left", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.83, title="")
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
brks <- round(quantile(random.effect, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
brks <- round(quantile(resid, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.8)
save.image("data.Rdata")
RR.simul=chosen.model$sims.list$RR
prob.vector = rep(NA, lunghezza)
for (i in 1:lunghezza) {
prob.vector[i]=sum(RR.simul[,i]>1) / (dim(RR.simul)[1])
}
PV = round(prob.vector, digits = 2)
brks <- round(quantile(PV, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(PV, brks,all.inside=TRUE)], main="P(RR>1)")
text(coordinates(NW.dataset), label=round(PV, digits=2),cex=0.5)
legend("left", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.83, title="")
RR.simul=chosen.model$sims.list$RR
prob.vector = rep(NA, lunghezza)
for (i in 1:lunghezza) {
prob.vector[i]=sum(RR.simul[,i]>1) / (dim(RR.simul)[1])
}
PV = round(prob.vector, digits = 2)
brks <- round(quantile(PV, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(PV, brks,all.inside=TRUE)], main="prob(RR>1)")
text(coordinates(NW.dataset), label=round(PV, digits=2),cex=0.5)
legend("left", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.83, title="")
# st.SMR<-(NW.dataset$SMR-mean(NW.dataset$SMR))/sd(NW.dataset$SMR)
# xx<-moran.plot(st.SMR, weight.object ,labels=as.factor(NW.dataset$NAME), pch=19, main="Moran Plot")
# plot(NW.dataset, col=my.colours[findInterval(NW.dataset$SMR, brks,all.inside=TRUE)])
# legend("right", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.4)
# title(main=paste("Standardized Mortality Rate (SMR) during 1982-1991"))
# text(coordinates(NW.dataset),label=as.factor(NW.dataset$NAME),cex=0.4)
model.2 <- glm(SMR ~ , offset = log(pop), family = poisson(link = "log"), data = data)
model.2 <- glm(SMR ~ 1, family = poisson(link = "log"), data = data)
data
model.2 <- glm(SMR ~ 1, family = poisson(link = "log"))
SMR
data$E
model.2 <- glm(SMR ~ 1, offset=data$E, family = poisson(link = "log"))
# summary(model.2)
typeof(SMR)
typeof(data$E)
SMR
model.2 <- glm(O ~ 1, offset=data$E, family = poisson(link = "log"))
model.2 <- glm(data$O ~ 1, offset=data$E, family = poisson(link = "log"))
summary(model.2)
model.2 <- glm(data$O ~ 1, offset=data$E, family = quasipoisson(link = "log"))
summary(model.2)
model.2 <- glm(data$O ~ 1, offset=data$E, family = poisson(link = "log"))
summary(model.2)
model.2 <- glm(O ~ 1, offset=E, family = quasipoisson(link = "log"), data=data)
model.2 <- glm(O ~ 1, offset=E, family = quasipoisson(link = "log"), data=data)
summary(model.2)
model.2 <- glm(O ~ 1, offset=E, family = poisson(link = "log"), data=data)
summary(model.2)
3557.1/143
model.glm <- glm(O ~ 1, offset=E, family = quasipoisson(link = "log"), data=data)
summary(model.glm)
summary(model.glm)$D
model.glm$coefficients
model.glm$deviance
3557/143
model.glm <- glm(O ~ , offset=E, family = quasipoisson(link = "log"), data=data)
model.glm <- glm(O ~ 1, offset=E, family = quasipoisson(link = "log"), data=data)
summary(model.glm)
model.glm$terms
prod( results.spatial$summary[,8] < 1.05 )
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
brks <- round(quantile(NW.dataset$SMR, probs=seq(0,1,0.2)), digits=2)
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.7,3))
plot(NW.dataset, col=my.colours[findInterval(SMR, brks,all.inside=TRUE)], main="SMR")
text(coordinates(NW.dataset), label=round(SMR, digits=2),cex=0.5)
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.83, title="Percentils")
plot.new()
legend("center", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=1, title="Percentils")
brks <- round(quantile(RR.vector, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(RR.vector, brks,all.inside=TRUE)], main="RR")
text(coordinates(NW.dataset), label=round(RR.vector, digits=2),cex=0.5)
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.83, title="Percentils")
RR.simul=chosen.model$sims.list$RR
prob.vector = rep(NA, lunghezza)
for (i in 1:lunghezza) {
prob.vector[i]=sum(RR.simul[,i]>1) / (dim(RR.simul)[1])
}
PV = round(prob.vector, digits = 2)
brks <- round(quantile(PV, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(PV, brks,all.inside=TRUE)], main="prob(RR>1)")
text(coordinates(NW.dataset), label=round(PV, digits=2),cex=0.5)
legend("left", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.83, title="")
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
brks <- round(quantile(random.effect, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
brks <- round(quantile(resid, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.8)
save.image("data.Rdata")
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
brks <- round(quantile(random.effect, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
brks <- round(quantile(resid, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("left", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2), nrow = 1))
# layout(matrix(c(1,2), nrow = 1))
brks <- round(quantile(random.effect, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
# plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
brks <- round(quantile(resid, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("left", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
brks <- round(quantile(random.effect, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
brks <- round(quantile(resid, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
brks <- round(quantile(random.effect, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
brks <- round(quantile(resid, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.8)
# brks <- round(quantile(resid, probs=seq(0,1,0.2)), digits=2)
brks = c( seq(min(resid), 0, length=2), seq(0, max(resid), length=2) )
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
seq(min(resid), 0, length=3)
seq(0, max(resid), length=2)
c( seq(min(resid), 0, length=3), seq(0, max(resid), length=3) )
brks = brks[-3]
brks
# brks <- round(quantile(resid, probs=seq(0,1,0.2)), digits=2)
brks = c( seq(min(resid), 0, length=3), seq(0, max(resid), length=3) )
brks = brks[-3]
brks
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
brks <- round(quantile(random.effect, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
# brks <- round(quantile(resid, probs=seq(0,1,0.2)), digits=2)
brks = c( seq(min(resid), 0, length=3), seq(0, max(resid), length=3) )
brks = brks[-3]
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
brks <- round(quantile(random.effect, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
# brks <- round(quantile(resid, probs=seq(0,1,0.2)), digits=2)
brks = c( seq(min(resid), 0, length=3), seq(0, max(resid), length=3) )
brks = brks[-3]
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
brks
# brks <- round(quantile(random.effect, probs=seq(0,1,0.2)), digits=2)
brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
brks = brks[-3]
brks
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
# brks <- round(quantile(random.effect, probs=seq(0,1,0.2)), digits=2)
brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
brks = brks[-3]
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
# brks <- round(quantile(random.effect, probs=seq(0,1,0.2)), digits=2)
brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
round(quantile(random.effect, probs=seq(0,1,0.2)), digits=2)
round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
# brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
my.colours <- c("green",, "lightblue" "orange2", "red3")
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
my.colours <- c("green","lightblue" "orange2", "red3")
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
my.colours <- c("green","lightblue", "orange2", "red3")
brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
my.colours <- c("green","yellow", "orange2", "red3")
brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# layout(matrix(c(1,2), nrow = 1))
my.colours <- c("green","aquamarine", "orange2", "red3")
brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.99)
my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# my.colours <- c("green","aquamarine", "orange2", "red3")
brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
# my.colours <- c("green","aquamarine", "orange2", "red3")
# brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
brks <- c(min(random.effect), -0.3, 0, 0.35, max(random.effect))
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
my.colours <- c("yellow", "orange2", "red3", "black")
# brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
brks <- c(min(random.effect), -0.3, 0, 0.35, max(random.effect))
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
my.colours <- c("yellow", "orange2", "red3", "brown", "black")
brks <- round(quantile(NW.dataset$SMR, probs=seq(0,1,0.2)), digits=2)
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.7,3))
plot(NW.dataset, col=my.colours[findInterval(SMR, brks,all.inside=TRUE)], main="SMR")
text(coordinates(NW.dataset), label=round(SMR, digits=2),cex=0.5)
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.83, title="Percentils")
plot.new()
legend("center", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=1, title="Percentils")
brks <- round(quantile(RR.vector, probs=seq(0,1,0.2)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(RR.vector, brks,all.inside=TRUE)], main="RR")
text(coordinates(NW.dataset), label=round(RR.vector, digits=2),cex=0.5)
# legend("bottom", legend=leglabs(names(brks)),fill=my.colours, bty="n",cex=0.83, title="Percentils")
resid=chosen.model$mean$resid
random.effect = log(resid)
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
my.colours <- c("green","aquamarine", "orange2", "red3")
# brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
brks <- c(min(random.effect), -0.3, 0, 0.35, max(random.effect))
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
my.colours <- c("darkgreen", "green", "orange2", "red3")
# brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
brks <- c(min(random.effect), -0.3, 0, 0.35, max(random.effect))
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# my.colours <- c("yellow", "orange2", "red3", "black")
brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
resid=chosen.model$mean$resid
random.effect = log(resid)
layout(matrix(c(1,2,3), nrow = 1), widths = c(3,1.2,3))
my.colours <- c("darkgreen", "green", "orange2", "red3")
# brks <- round(quantile(random.effect, probs=seq(0,1,0.25)), digits=2)
brks <- c(min(random.effect), -0.3, 0, 0.35, max(random.effect))
# brks = c( seq(min(random.effect), 0, length=3), seq(0, max(random.effect), length=3) )
# brks = round(brks[-3], digits=2)
plot(NW.dataset, col=my.colours[findInterval(random.effect, brks,all.inside=TRUE)], main="Random Effect")
text(coordinates(NW.dataset), label=round(random.effect, digits=2),cex=0.5)
legend( "bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
plot.new()
# my.colours <- c("yellow", "orange2", "red3", "black")
# brks <- round(quantile(resid, probs=seq(0,1,0.25)), digits=2)
brks = c(min(resid), 0.74, 1, 1.41, max(resid))
plot(NW.dataset, col=my.colours[findInterval(resid, brks,all.inside=TRUE)], main="resid")
text(coordinates(NW.dataset), label=round(resid, digits=2),cex=0.5)
legend("bottom", legend=leglabs(brks),fill=my.colours, bty="n",cex=0.8)
